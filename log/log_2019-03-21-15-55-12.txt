DEBUG:root:force_stable : True
cuda_device : 0
aux_device : 1
base_epoch : 0
eos_m_token : EOS_M
base_iter : 0
beam_len_bonus : 0.5
max_turn : 10
trunc_turn : 999
mode : unknown
m : SEDST
prev_z_method : none
last_turn_only : False
u_max_ts : 100
freq_thres : 0
intent : all
vocab_size : 1400
embedding_size : 50
hidden_size : 50
split : None
lr : 0.0005
q_hidden_size : 50
lr_decay : 0.5
vocab_path : ./vocab/vocab10_slot_space.pkl
train : ./data/kvret/kvret_train_public.json
dev : ./data/kvret/kvret_dev_public.json
test : ./data/kvret/kvret_test_public.json
entity : ./data/kvret/kvret_entities.json
glove_path : ./data/glove/glove.6B.50d.txt
batch_size : 32
degree_size : 2
z_length : 27
layer_num : 1
dropout_rate : 0.5
epoch_num : 100
cuda : False
spv_proportion : 50
alpha : 0.1
max_ts : 40
early_stop_count : 5
new_vocab : True
model_path : ./models/kvret.pkl
result_path : ./results/kvret.csv
teacher_force : 100
beam_search : False
beam_size : 5
sampling : False
unfrz_attn_epoch : 0
skip_unsup : False
truncated : False
pretrain : False

INFO:root:1257 known embedding. old mean: -0.002902 new mean 0.037428, old std 0.999065 new std 0.675230
DEBUG:root:bucket 2 instance 810
DEBUG:root:bucket 3 instance 984
DEBUG:root:bucket 4 instance 293
DEBUG:root:bucket 1 instance 283
DEBUG:root:bucket 5 instance 48
DEBUG:root:bucket 6 instance 4
DEBUG:root:bucket 0 instance 3
DEBUG:root:supervised loss:21.45571517944336 pr_loss:7.203672885894775 m_loss:7.239776611328125 q_loss:7.012266635894775 grad:0.9775739379897467
DEBUG:root:supervised loss:21.487316131591797 pr_loss:7.223416328430176 m_loss:7.2257080078125 q_loss:7.038191318511963 grad:1.3253235612477128
DEBUG:root:supervised loss:21.48055648803711 pr_loss:7.208474159240723 m_loss:7.219087600708008 q_loss:7.052994251251221 grad:1.0812045454706298
DEBUG:root:supervised loss:21.34984016418457 pr_loss:7.181758880615234 m_loss:7.189845085144043 q_loss:6.978236198425293 grad:1.0736661449413325
DEBUG:root:supervised loss:21.35474395751953 pr_loss:7.185313701629639 m_loss:7.175350666046143 q_loss:6.994080543518066 grad:1.4818991439128995
DEBUG:root:supervised loss:21.368629455566406 pr_loss:7.180973529815674 m_loss:7.171358108520508 q_loss:7.016299247741699 grad:1.2057296626193499
DEBUG:root:supervised loss:21.13776397705078 pr_loss:7.108044624328613 m_loss:7.15583610534668 q_loss:6.873883247375488 grad:1.1023163685393587
DEBUG:root:supervised loss:21.012380599975586 pr_loss:7.0818867683410645 m_loss:7.066001892089844 q_loss:6.864491939544678 grad:1.5856210487828146
DEBUG:root:supervised loss:20.850431442260742 pr_loss:7.012684345245361 m_loss:7.076358318328857 q_loss:6.761388778686523 grad:1.3830529096151676
DEBUG:root:supervised loss:20.794342041015625 pr_loss:6.995372772216797 m_loss:7.044667720794678 q_loss:6.75430154800415 grad:1.6458338501813266
DEBUG:root:unsupervised loss:7.100130081176758 m_loss:7.097051620483398 kl_div_loss:0.003078493056818843 grad:0.47456708601348996
DEBUG:root:unsupervised loss:7.084364414215088 m_loss:7.079937934875488 kl_div_loss:0.004426253493875265 grad:0.48854352491086495
DEBUG:root:unsupervised loss:7.029724597930908 m_loss:7.027200222015381 kl_div_loss:0.0025244595017284155 grad:0.8083403253280553
DEBUG:root:unsupervised loss:7.015769958496094 m_loss:7.011839389801025 kl_div_loss:0.003930351231247187 grad:0.5452153646548934
DEBUG:root:unsupervised loss:6.99714469909668 m_loss:6.991642475128174 kl_div_loss:0.0055021983571350574 grad:0.522409157512015
DEBUG:root:unsupervised loss:6.859855651855469 m_loss:6.8541975021362305 kl_div_loss:0.005658144596964121 grad:1.1967452171140924
DEBUG:root:supervised loss:20.048301696777344 pr_loss:6.759651184082031 m_loss:6.870654106140137 q_loss:6.417996883392334 grad:2.1615687722240593
DEBUG:root:supervised loss:19.768503189086914 pr_loss:6.668099880218506 m_loss:6.7836222648620605 q_loss:6.316781520843506 grad:2.4724576380629597
DEBUG:root:unsupervised loss:6.801082611083984 m_loss:6.794454097747803 kl_div_loss:0.0066286916844546795 grad:0.8358741186009873
DEBUG:root:supervised loss:19.5449275970459 pr_loss:6.553106307983398 m_loss:6.725330829620361 q_loss:6.266490459442139 grad:2.6967027396473617
DEBUG:root:supervised loss:19.528209686279297 pr_loss:6.579064846038818 m_loss:6.6203389167785645 q_loss:6.328806400299072 grad:2.68757543607652
DEBUG:root:supervised loss:19.219621658325195 pr_loss:6.432659149169922 m_loss:6.604176998138428 q_loss:6.182784557342529 grad:3.0988480608115783
DEBUG:root:supervised loss:19.2871150970459 pr_loss:6.505153179168701 m_loss:6.41807222366333 q_loss:6.363890171051025 grad:3.248301598222797
DEBUG:root:supervised loss:18.429834365844727 pr_loss:6.207910060882568 m_loss:6.150949478149414 q_loss:6.070973873138428 grad:4.303102272218826
DEBUG:root:supervised loss:18.769145965576172 pr_loss:6.384481906890869 m_loss:6.215925216674805 q_loss:6.168739318847656 grad:3.6388131961798114
DEBUG:root:unsupervised loss:6.436580181121826 m_loss:6.430646896362305 kl_div_loss:0.005933482199907303 grad:1.096383496599702
DEBUG:root:unsupervised loss:6.114926338195801 m_loss:6.105438709259033 kl_div_loss:0.00948779471218586 grad:1.0753593699739217
DEBUG:root:unsupervised loss:5.988398551940918 m_loss:5.974339485168457 kl_div_loss:0.014058833010494709 grad:1.1756994782441454
DEBUG:root:unsupervised loss:5.835974216461182 m_loss:5.821313858032227 kl_div_loss:0.014660149812698364 grad:2.3640746711475185
DEBUG:root:unsupervised loss:6.389878749847412 m_loss:6.369027614593506 kl_div_loss:0.02085118182003498 grad:5.782772533558622
DEBUG:root:unsupervised loss:5.866616249084473 m_loss:5.832886219024658 kl_div_loss:0.03373011201620102 grad:3.0429375919396517
DEBUG:root:unsupervised loss:5.99204158782959 m_loss:5.9562087059021 kl_div_loss:0.035832736641168594 grad:3.312142934770893
DEBUG:root:unsupervised loss:5.610654354095459 m_loss:5.576056480407715 kl_div_loss:0.03459785878658295 grad:2.5075125851474747
DEBUG:root:unsupervised loss:5.9550933837890625 m_loss:5.91848611831665 kl_div_loss:0.03660736605525017 grad:1.8636747148309774
DEBUG:root:unsupervised loss:5.73989200592041 m_loss:5.687540531158447 kl_div_loss:0.05235162377357483 grad:1.4805913547338407
DEBUG:root:unsupervised loss:5.754849433898926 m_loss:5.704193115234375 kl_div_loss:0.050656385719776154 grad:1.2475312999893482
DEBUG:root:unsupervised loss:5.329658508300781 m_loss:5.29887056350708 kl_div_loss:0.030787894502282143 grad:2.7991367749430793
DEBUG:root:supervised loss:17.634075164794922 pr_loss:7.244265556335449 m_loss:4.969029426574707 q_loss:5.420780181884766 grad:15.312802305743988
DEBUG:root:supervised loss:17.555294036865234 pr_loss:7.099872589111328 m_loss:5.004592418670654 q_loss:5.450827598571777 grad:15.032766919648811
DEBUG:root:unsupervised loss:5.032088279724121 m_loss:4.986016273498535 kl_div_loss:0.04607204347848892 grad:2.2771221657501006
DEBUG:root:unsupervised loss:4.940371513366699 m_loss:4.900967121124268 kl_div_loss:0.039404451847076416 grad:2.061282576614603
DEBUG:root:unsupervised loss:5.436086654663086 m_loss:5.401453971862793 kl_div_loss:0.03463262692093849 grad:1.992272013521114
DEBUG:root:unsupervised loss:5.236203193664551 m_loss:5.201205253601074 kl_div_loss:0.03499813750386238 grad:1.3169020968363985
DEBUG:root:unsupervised loss:4.860334873199463 m_loss:4.839114189147949 kl_div_loss:0.021220799535512924 grad:2.487436049131424
DEBUG:root:unsupervised loss:4.7988505363464355 m_loss:4.7692670822143555 kl_div_loss:0.029583295807242393 grad:2.658924550932912
DEBUG:root:supervised loss:15.507779121398926 pr_loss:5.613079071044922 m_loss:4.751680850982666 q_loss:5.143019676208496 grad:6.370252193359551
DEBUG:root:supervised loss:15.224148750305176 pr_loss:5.8431243896484375 m_loss:4.346169948577881 q_loss:5.034853935241699 grad:10.165341272010277
DEBUG:root:unsupervised loss:5.182522296905518 m_loss:5.160930156707764 kl_div_loss:0.02159203216433525 grad:2.0585118326754372
DEBUG:root:unsupervised loss:5.03396463394165 m_loss:5.003900527954102 kl_div_loss:0.030064184218645096 grad:1.6961209006468516
DEBUG:root:unsupervised loss:4.526232719421387 m_loss:4.498645782470703 kl_div_loss:0.02758709155023098 grad:2.1665266600010304
DEBUG:root:supervised loss:14.606914520263672 pr_loss:5.0947465896606445 m_loss:4.6526031494140625 q_loss:4.859564781188965 grad:6.59184113915041
DEBUG:root:supervised loss:13.822402954101562 pr_loss:5.02864933013916 m_loss:4.367023944854736 q_loss:4.426729679107666 grad:7.022052934954697
DEBUG:root:unsupervised loss:5.045273303985596 m_loss:5.023869037628174 kl_div_loss:0.02140425704419613 grad:1.2319441298343434
DEBUG:root:unsupervised loss:4.6768693923950195 m_loss:4.6442341804504395 kl_div_loss:0.03263523802161217 grad:2.2186899921861887
DEBUG:root:unsupervised loss:4.334253787994385 m_loss:4.305264472961426 kl_div_loss:0.028989383950829506 grad:2.36495134304084
DEBUG:root:unsupervised loss:4.475861072540283 m_loss:4.448230266571045 kl_div_loss:0.027630779892206192 grad:3.2857197459551535
DEBUG:root:unsupervised loss:4.850978851318359 m_loss:4.827360153198242 kl_div_loss:0.02361847274005413 grad:2.0495153136258484
DEBUG:root:unsupervised loss:5.022603511810303 m_loss:4.99630880355835 kl_div_loss:0.026294860988855362 grad:1.6028399371305024
DEBUG:root:unsupervised loss:4.144476413726807 m_loss:4.122955799102783 kl_div_loss:0.02152070961892605 grad:2.5291050484672852
DEBUG:root:supervised loss:14.45604133605957 pr_loss:4.971995830535889 m_loss:4.926831245422363 q_loss:4.557214736938477 grad:6.725612006031541
DEBUG:root:supervised loss:13.597744941711426 pr_loss:4.429965019226074 m_loss:5.014919757843018 q_loss:4.152859687805176 grad:10.987836810027742
DEBUG:root:supervised loss:12.046910285949707 pr_loss:4.2468953132629395 m_loss:3.9427454471588135 q_loss:3.857269525527954 grad:13.24343468922974
DEBUG:root:supervised loss:12.851448059082031 pr_loss:4.213621139526367 m_loss:4.548701763153076 q_loss:4.0891242027282715 grad:7.373577363432417
DEBUG:root:supervised loss:10.882681846618652 pr_loss:3.5507359504699707 m_loss:4.119907855987549 q_loss:3.2120378017425537 grad:9.94838179560272
DEBUG:root:unsupervised loss:4.9324564933776855 m_loss:4.904172420501709 kl_div_loss:0.02828430011868477 grad:1.409665716660078
DEBUG:root:unsupervised loss:4.980060577392578 m_loss:4.954625606536865 kl_div_loss:0.025435006245970726 grad:2.2589127086147576
DEBUG:root:unsupervised loss:5.058131217956543 m_loss:5.035566329956055 kl_div_loss:0.022564753890037537 grad:3.543514884703053
DEBUG:root:unsupervised loss:4.000915050506592 m_loss:3.98317289352417 kl_div_loss:0.017742007970809937 grad:4.426785714237889
DEBUG:root:unsupervised loss:4.7190423011779785 m_loss:4.681102752685547 kl_div_loss:0.037939585745334625 grad:1.7606589266189518
DEBUG:root:unsupervised loss:4.7706403732299805 m_loss:4.746222972869873 kl_div_loss:0.024417316541075706 grad:2.3057868294125488
DEBUG:root:unsupervised loss:4.8997039794921875 m_loss:4.884300708770752 kl_div_loss:0.01540328748524189 grad:2.2978478637378643
DEBUG:root:unsupervised loss:4.0074005126953125 m_loss:3.995098829269409 kl_div_loss:0.012301594950258732 grad:6.151525115949905
DEBUG:root:unsupervised loss:4.70609188079834 m_loss:4.660610198974609 kl_div_loss:0.04548155143857002 grad:2.7978308867765778
DEBUG:root:unsupervised loss:5.128052711486816 m_loss:5.0996479988098145 kl_div_loss:0.028404762968420982 grad:2.3221724933990457
DEBUG:root:unsupervised loss:3.7873315811157227 m_loss:3.7661914825439453 kl_div_loss:0.021140050143003464 grad:2.7379967443902844
DEBUG:root:unsupervised loss:4.630580425262451 m_loss:4.596068859100342 kl_div_loss:0.0345117561519146 grad:6.2800411319663025
DEBUG:root:supervised loss:12.038896560668945 pr_loss:3.5300838947296143 m_loss:4.814142227172852 q_loss:3.6946702003479004 grad:17.02098434942032
DEBUG:root:supervised loss:11.588651657104492 pr_loss:3.3254525661468506 m_loss:4.802392959594727 q_loss:3.460805892944336 grad:10.144166954134072
DEBUG:root:supervised loss:9.348468780517578 pr_loss:2.6533377170562744 m_loss:3.8149542808532715 q_loss:2.8801770210266113 grad:10.015913468495587
DEBUG:root:unsupervised loss:4.6831746101379395 m_loss:4.654980659484863 kl_div_loss:0.028194084763526917 grad:2.187253795512446
DEBUG:root:unsupervised loss:4.941329002380371 m_loss:4.902080535888672 kl_div_loss:0.03924862667918205 grad:1.2608616249524134
DEBUG:root:unsupervised loss:4.9271135330200195 m_loss:4.896139144897461 kl_div_loss:0.030974512919783592 grad:2.1114170556602927
DEBUG:root:unsupervised loss:3.7606942653656006 m_loss:3.7351791858673096 kl_div_loss:0.02551518939435482 grad:2.641844984307808
DEBUG:root:supervised loss:11.083032608032227 pr_loss:3.3367629051208496 m_loss:4.510993003845215 q_loss:3.235276460647583 grad:8.567220435770285
DEBUG:root:supervised loss:9.087642669677734 pr_loss:2.6776347160339355 m_loss:4.143298625946045 q_loss:2.266709089279175 grad:14.235267575711449
DEBUG:root:supervised loss:11.722835540771484 pr_loss:3.5067832469940186 m_loss:4.845757961273193 q_loss:3.3702943325042725 grad:6.115245627818616
DEBUG:root:supervised loss:10.421130180358887 pr_loss:2.985886812210083 m_loss:4.937321186065674 q_loss:2.497921943664551 grad:9.982534168949295
DEBUG:root:supervised loss:8.378841400146484 pr_loss:2.4087414741516113 m_loss:3.563807725906372 q_loss:2.4062914848327637 grad:20.524526384485384
DEBUG:root:unsupervised loss:4.572802543640137 m_loss:4.544007301330566 kl_div_loss:0.028795471414923668 grad:1.5941235304314736
DEBUG:root:unsupervised loss:4.864558219909668 m_loss:4.834245204925537 kl_div_loss:0.03031310811638832 grad:2.114410431252563
DEBUG:root:unsupervised loss:4.2219157218933105 m_loss:4.191125392913818 kl_div_loss:0.030790481716394424 grad:2.081998275476976
DEBUG:root:supervised loss:10.320837020874023 pr_loss:3.0378661155700684 m_loss:4.59120512008667 q_loss:2.691765546798706 grad:7.7132225966260295
DEBUG:root:supervised loss:8.837827682495117 pr_loss:2.5335886478424072 m_loss:4.0436248779296875 q_loss:2.2606146335601807 grad:14.134103188759289
DEBUG:root:unsupervised loss:4.555864334106445 m_loss:4.526635646820068 kl_div_loss:0.02922852151095867 grad:1.3695222784816488
DEBUG:root:unsupervised loss:4.691706657409668 m_loss:4.662511825561523 kl_div_loss:0.029194733127951622 grad:2.7223662111295863
DEBUG:root:unsupervised loss:4.0232439041137695 m_loss:3.998540163040161 kl_div_loss:0.024703849107027054 grad:3.669985975151564
DEBUG:root:supervised loss:10.43187141418457 pr_loss:3.116631031036377 m_loss:4.58757209777832 q_loss:2.727668285369873 grad:5.06971487251828
DEBUG:root:supervised loss:8.064294815063477 pr_loss:2.2883710861206055 m_loss:4.071987152099609 q_loss:1.7039363384246826 grad:8.007954531302312
DEBUG:root:unsupervised loss:4.634765148162842 m_loss:4.605771064758301 kl_div_loss:0.028993969783186913 grad:1.671567900862453
DEBUG:root:unsupervised loss:4.872933387756348 m_loss:4.842611312866211 kl_div_loss:0.030322114005684853 grad:1.9486554581390372
DEBUG:root:unsupervised loss:3.6406807899475098 m_loss:3.6126110553741455 kl_div_loss:0.02806966006755829 grad:2.7273454150826413
DEBUG:root:supervised loss:9.59327507019043 pr_loss:2.7117228507995605 m_loss:4.5198869705200195 q_loss:2.3616652488708496 grad:10.354016493427107
DEBUG:root:supervised loss:7.694488525390625 pr_loss:2.0201148986816406 m_loss:3.9289557933807373 q_loss:1.7454174757003784 grad:8.574780108305747
DEBUG:root:supervised loss:9.879769325256348 pr_loss:2.8375141620635986 m_loss:4.430465221405029 q_loss:2.6117899417877197 grad:7.481040381932513
DEBUG:root:supervised loss:7.191296100616455 pr_loss:1.9767674207687378 m_loss:3.500359296798706 q_loss:1.7141693830490112 grad:10.938576553396308
DEBUG:root:supervised loss:9.246891021728516 pr_loss:2.6693615913391113 m_loss:4.3864593505859375 q_loss:2.1910698413848877 grad:7.098942053414851
DEBUG:root:supervised loss:7.19620418548584 pr_loss:1.8480865955352783 m_loss:3.705127477645874 q_loss:1.642990231513977 grad:8.076915826917027
DEBUG:root:unsupervised loss:4.8010358810424805 m_loss:4.763906955718994 kl_div_loss:0.03712901100516319 grad:1.8339611086440417
DEBUG:root:unsupervised loss:5.012062072753906 m_loss:4.963741302490234 kl_div_loss:0.04832099378108978 grad:6.805797683332396
DEBUG:root:unsupervised loss:3.9803898334503174 m_loss:3.9497756958007812 kl_div_loss:0.03061409294605255 grad:2.0964430864120125
DEBUG:root:unsupervised loss:4.5366997718811035 m_loss:4.504800319671631 kl_div_loss:0.031899288296699524 grad:2.3487116548718383
DEBUG:root:unsupervised loss:4.902841091156006 m_loss:4.853758335113525 kl_div_loss:0.04908261075615883 grad:2.6936028670275207
DEBUG:root:unsupervised loss:5.070676326751709 m_loss:5.029715538024902 kl_div_loss:0.040960654616355896 grad:2.70767043070724
DEBUG:root:unsupervised loss:4.079442024230957 m_loss:4.040493965148926 kl_div_loss:0.038947831839323044 grad:4.251038583917633
DEBUG:root:unsupervised loss:4.395825386047363 m_loss:4.363471031188965 kl_div_loss:0.03235418722033501 grad:3.7437851848934933
DEBUG:root:unsupervised loss:4.803758144378662 m_loss:4.772293567657471 kl_div_loss:0.03146477788686752 grad:2.4635234667329504
DEBUG:root:unsupervised loss:4.675567626953125 m_loss:4.638294696807861 kl_div_loss:0.03727313503623009 grad:1.7662972206543353
DEBUG:root:unsupervised loss:4.900685787200928 m_loss:4.862652778625488 kl_div_loss:0.038032930344343185 grad:2.7315982815051796
DEBUG:root:unsupervised loss:4.719880104064941 m_loss:4.682168006896973 kl_div_loss:0.03771210089325905 grad:3.789354356776804
DEBUG:root:unsupervised loss:3.526254415512085 m_loss:3.489927291870117 kl_div_loss:0.036327067762613297 grad:3.0601844356561103
DEBUG:root:unsupervised loss:4.4822468757629395 m_loss:4.452731609344482 kl_div_loss:0.029515448957681656 grad:1.438825595949799
DEBUG:root:unsupervised loss:4.713197231292725 m_loss:4.672323226928711 kl_div_loss:0.04087409749627113 grad:2.091308501553712
